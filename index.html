<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Mirror Dungeon Randomiser</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>Mirror Dungeon Randomiser</h1>

  <!-- Run setup -->
  <section id="runSetupSection">
  <h2>Run setup</h2>

    <!-- Number of Sinners + toggle -->
  <div class="run-field-group">
    <label class="inline-toggle-label">
      <input type="checkbox" id="randomizeNumSinnersToggle" checked>
      Randomise number of Sinners (1–11); leave unchecked to randomise all 12 Sinners
    </label>

    <label>
      <span class="field-label">How many Sinners?</span>
      <select id="numSinners">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11" selected>11</option>
      </select>
    </label>
  </div>

  <div id="manualSinnerSelect" class="hidden">
  <label class="inline-toggle-label">
    <input type="checkbox" id="useManualSinnerSelection">
    <span id="manualSinnerHelpText">
      Select the Sinners you wish to randomise (leave unchecked if you want the randomiser to pick the Sinners for you)
    </span>
  </label>
  <div id="manualSinnerCheckboxes" class="sinner-select-grid"></div>
</div>

  <!-- EGOs per Sinner + rank filter toggle -->
<div class="run-field-group">
  <label>
    EGOs per Sinner (1–5):
    <select id="egosPerSinner">
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3" selected>3</option>
      <option value="4">4</option>
      <option value="5">5</option>
    </select>
  </label>

  <label class="inline-toggle-label">
    <input type="checkbox" id="randomizeEgoRanksToggle">
    Randomise certain ranks of EGO
  </label>
</div>

<!-- EGO rank filter (only visible when the above toggle is ON) -->
<div id="egoRankFilterContainer" class="hidden">
  <p>Which EGO ranks can be randomised?</p>

  <label class="keyword-filter">
    <input type="checkbox" data-ego-rank="ZAYIN" id="egoRankZayin" checked>
    ZAYIN
  </label>
  <label class="keyword-filter">
    <input type="checkbox" data-ego-rank="TETH" id="egoRankTeth" checked>
    TETH
  </label>
  <label class="keyword-filter">
    <input type="checkbox" data-ego-rank="HE" id="egoRankHe" checked>
    HE
  </label>
  <label class="keyword-filter">
    <input type="checkbox" data-ego-rank="WAW" id="egoRankWaw" checked>
    WAW
  </label>
  <label class="keyword-filter">
    <input type="checkbox" data-ego-rank="ALEPH" id="egoRankAleph" disabled>
    ALEPH (not available yet)
  </label>

  <p class="small-note">
    Note: each Sinner always brings exactly one ZAYIN EGO. If ZAYIN is unchecked here,
    they will keep their base ZAYIN instead of randomising it.
  </p>
</div>

  <!-- EGO rank filter (only visible when the above toggle is ON) -->
  <div id="egoRankFilterContainer" class="hidden">
    <p>Which EGO ranks can be randomised?</p>
    <label class="keyword-filter">
      <input type="checkbox" data-ego-rank="ZAYIN" id="egoRankZayin" checked>
      ZAYIN
    </label>
    <label class="keyword-filter">
      <input type="checkbox" data-ego-rank="TETH" id="egoRankTeth" checked>
      TETH
    </label>
    <label class="keyword-filter">
      <input type="checkbox" data-ego-rank="HE" id="egoRankHe" checked>
      HE
    </label>
    <label class="keyword-filter">
      <input type="checkbox" data-ego-rank="WAW" id="egoRankWaw" checked>
      WAW
    </label>
    <label class="keyword-filter">
      <input type="checkbox" data-ego-rank="ALEPH" id="egoRankAleph" disabled>
      ALEPH (not available yet)
    </label>
    <p class="small-note">
      Note: each Sinner always brings exactly one ZAYIN EGO. If ZAYIN is unchecked here,
      they will keep their base ZAYIN instead of randomising it.
    </p>
  </div>

  <!-- Deployment order -->
  <div class="run-field-group">
    <label>
      <input type="checkbox" id="randomizeOrder">
      Randomise deployment order (1–7 on-field, rest support)
    </label>
  </div>

  <!-- Run + preset buttons -->
  <div class="run-buttons">
    <button id="randomizeRunBtn">Randomise Run</button>
    <button id="saveRunPresetBtn" class="hidden">
      Save latest randomiser settings as preset
    </button>
  </div>

  <h3>Result</h3>
  <pre id="runResult"></pre>
  <button id="copyResultBtn">Copy result to clipboard</button>
</section>

<!-- New section: saved run presets -->
<section id="runPresetsSection">
  <h2>Run presets</h2>
  <div class="preset-controls">
    <label>
      Preset name:
      <input type="text" id="runPresetNameInput" placeholder="e.g. 8 Sinners, Bleed/Tremor focus">
    </label>
    <button id="clearRunPresetsBtn">Clear all presets</button>
  </div>
  <div id="savedRunPresetsContainer">No presets saved yet.</div>
</section>


  <!-- Ownership settings -->
  <section id="settings">
  <h2>Owned IDs/EGOs</h2>
  <p>
    Tick the Identities and EGOs you own. Base LCB Identities and base ZAYIN EGOs
    are always available as a fallback.
  </p>

  <div id="ownershipSearchBar">
    <label>
      Search IDs / EGOs:
      <input
        type="text"
        id="ownershipSearchInput"
        placeholder="e.g. Yi Sang, Solemn Lament, Lantern"
      >
    </label>
    <button id="ownershipSearchBtn">Search</button>
    <button id="ownershipClearSearchBtn">Clear search</button>
  </div>

  <!-- NEW: keyword filter bar -->
  <div id="keywordFilterBar">
  <button id="toggleKeywordFiltersBtn">Filter by keyword</button>
  <span id="activeKeywordFiltersDisplay">No keyword filters active</span>
  <button id="clearKeywordFiltersBtn">Clear keyword filters</button>

  <div id="keywordFilters" class="hidden">
    <p>Select one or more keywords:</p>
    <label class="keyword-filter">
      <input type="checkbox" data-keyword="burn"> Burn
    </label>
    <label class="keyword-filter">
      <input type="checkbox" data-keyword="bleed"> Bleed
    </label>
    <label class="keyword-filter">
      <input type="checkbox" data-keyword="tremor"> Tremor
    </label>
    <label class="keyword-filter">
      <input type="checkbox" data-keyword="sinking"> Sinking
    </label>
    <label class="keyword-filter">
      <input type="checkbox" data-keyword="rupture"> Rupture
    </label>
    <label class="keyword-filter">
      <input type="checkbox" data-keyword="poise"> Poise
    </label>
    <label class="keyword-filter">
      <input type="checkbox" data-keyword="charge"> Charge
    </label>
    <label class="keyword-filter">
      <input type="checkbox" data-keyword="slash"> Slash
    </label>
    <label class="keyword-filter">
      <input type="checkbox" data-keyword="blunt"> Blunt
    </label>
    <label class="keyword-filter">
      <input type="checkbox" data-keyword="pierce"> Pierce
    </label>
  </div>
</div>

  <button id="toggleSettings">Show / hide IDs/EGOs</button>
  <button id="resetOwnershipBtn">Reset to LCB ID/base ZAYIN EGO only</button>
  <button id="selectAllIdsBtn">Select all IDs</button>
  <button id="selectAllEgosBtn">Select all EGOs</button>
  <button id="selectAllOwnershipBtn">Select all IDs/EGOs</button>

  <div id="ownershipContainer" class="hidden"></div>
</section>

  <!-- Saved teams -->
  <section id="saved-teams">
    <h2>Saved teams</h2>
    <label>
      Team name:
      <input type="text" id="saveTeamName" placeholder="e.g. Funny Bleed Run">
    </label>
    <button id="saveTeamBtn">Save current result</button>
    <button id="clearTeamsBtn">Clear all saved teams</button>

    <div id="savedTeamsList"></div>
  </section>

  <script src="data.js"></script>
  <script src="main.js"></script>
</body>
</html>
